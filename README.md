# TODO List (v2): โปรเจกต์ดึงข้อมูลจาก PLC Omron และบันทึกลง Database

โปรเจกต์นี้แบ่งออกเป็น 7 Phase หลักๆ เพื่อให้ง่ายต่อการติดตามและจัดการ

---

### Phase 1: การเตรียมการและศึกษาข้อมูล (Preparation & Research)

- [ ] **1.1 กำหนดเป้าหมายของโปรแกรม:**
  - [ ] ต้องการดึงข้อมูลจาก Memory Area ไหนของ PLC (เช่น DM, CIO, WR, HR)?
  - [ ] ต้องการดึงข้อมูลอะไรบ้าง (เช่น ค่าอุณหภูมิ, สถานะมอเตอร์, จำนวนการผลิต)?
  - [ ] จะดึงข้อมูลด้วยความถี่เท่าไหร่ (เช่น ทุกๆ 1 วินาที, 5 วินาที)?
  - [ ] จะนำข้อมูลที่ได้ไปทำอะไรต่อ (เช่น แสดงผลบนหน้าจอ, บันทึกลงฐานข้อมูล, ส่งต่อไปยังระบบอื่น)?
  - [ ] จะออกแบบตารางในฐานข้อมูล (Schema) อย่างไร? (เช่น มี column อะไรบ้าง, data type คืออะไร)

- [ ] **1.2 เตรียม Hardware ที่จำเป็น:**
  - [ ] PLC Omron รุ่นที่รองรับ FINS/UDP หรือ FINS/TCP.
  - [ ] คอมพิวเตอร์สำหรับเขียนโปรแกรม
  - [ ] สาย LAN สำหรับเชื่อมต่อคอมพิวเตอร์กับ PLC

- [ ] **1.3 เตรียม Software และเครื่องมือ:**
  - [ ] **CX-Programmer:** สำหรับตั้งค่า PLC
  - [ ] **Programming Environment:** เลือกภาษาที่ถนัด เช่น Python, C#, Node.js
  - [ ] **Database:** เลือกฐานข้อมูลที่เหมาะสม
    - **SQLite:** ง่ายที่สุด เหมาะสำหรับโปรเจกต์ขนาดเล็ก ไม่ต้องติดตั้ง Server
    - **MySQL/PostgreSQL:** เหมาะสำหรับโปรเจกต์ขนาดใหญ่ รองรับข้อมูลจำนวนมาก
    - **InfluxDB:** เหมาะสำหรับงาน Time-series data โดยเฉพาะ
  - [ ] **Database Management Tool:** (เช่น DBeaver, HeidiSQL, pgAdmin)

- [ ] **1.4 ศึกษาพื้นฐาน FINS Protocol:**
  - [ ] ทำความเข้าใจโครงสร้างของ FINS command
  - [ ] ทำความเข้าใจการระบุตำแหน่ง Memory Address
  - [ ] ศึกษาความแตกต่างระหว่าง FINS/TCP และ FINS/UDP

---

### Phase 2: การตั้งค่าฝั่ง PLC (PLC Configuration)

- [ ] **2.1 ตั้งค่า IP Address ให้กับ PLC**
- [ ] **2.2 ตั้งค่า FINS Node Address**
- [ ] **2.3 ตรวจสอบการเชื่อมต่อ (Ping Test)**

---

### Phase 3: การตั้งค่า Environment สำหรับเขียนโปรแกรม (Development Setup)

- [ ] **3.1 ติดตั้งภาษาโปรแกรมและ IDE ที่เลือก**
- [ ] **3.2 ติดตั้ง Library สำหรับ FINS Protocol**
- [ ] **3.3 ติดตั้ง Library สำหรับเชื่อมต่อ Database:**
  - [ ] **สำหรับ Python:** `pip install sqlite3`, `pip install mysql-connector-python`, `pip install psycopg2`
- [ ] **3.4 สร้างโปรเจกต์ใหม่**

---

### Phase 4: การเขียนโค้ด (Implementation)

- [ ] **4.1 ส่วนของการเชื่อมต่อ (PLC Connection)**
- [ ] **4.2 ส่วนของการอ่านข้อมูล (Data Reading)**
- [ ] **4.3 ส่วนของการแปลงและจัดการข้อมูล (Data Handling)**
- [ ] **4.4 ส่วนของ Loop การทำงานหลัก**
- [ ] **4.5 (ปรับปรุง) ส่วนของการแสดงผลและส่งต่อข้อมูล:**
  - [ ] แสดงผลค่าที่อ่านได้ทาง Console (เพื่อการดีบัก)
  - [ ] **เรียกใช้ฟังก์ชันสำหรับบันทึกข้อมูลลง Database**

---

### Phase 5: การทดสอบและดีบัก (Testing & Debugging)

- [ ] **5.1 ทดสอบการเชื่อมต่อ PLC**
- [ ] **5.2 ทดสอบการอ่านค่าจาก PLC**
- [ ] **5.3 ดีบักเมื่อเกิดปัญหา (การสื่อสาร, การอ่านค่า)**

---

### Phase 6: การทำให้สมบูรณ์และนำไปใช้งาน (Refinement & Deployment)

- [ ] **6.1 ปรับปรุงโค้ด (Refactoring)**
- [ ] **6.2 สร้างหน้าจอแสดงผล (GUI - Optional)**
- [ ] **6.3 สร้างเป็นไฟล์ Executable**
- [ ] **6.4 จัดทำเอกสาร (Documentation)**

---

### Phase 7: การเชื่อมต่อและบันทึกข้อมูลลงฐานข้อมูล (Database Integration)

- [ ] **7.1 ออกแบบและสร้างตาราง (Create Table):**
  - [ ] เปิดโปรแกรม Database Management Tool
  - [ ] สร้าง Database ใหม่ (ถ้ายังไม่มี)
  - [ ] เขียน SQL Script เพื่อสร้างตารางตามที่ออกแบบไว้ในข้อ 1.1
  - [ ] *ตัวอย่าง:* สร้างตารางชื่อ `plc_data` ที่มี columns: `id` (Primary Key, Auto Increment), `timestamp` (เก็บเวลาที่บันทึก), `temperature` (FLOAT), `motor_status` (BOOLEAN), `production_count` (INTEGER)

- [ ] **7.2 เขียนโค้ดส่วนเชื่อมต่อ Database:**
  - [ ] Import library ของ Database ที่ติดตั้งไว้
  - [ ] เขียนฟังก์ชันสำหรับสร้างการเชื่อมต่อ (Connection) ไปยัง Database
  - [ ] ใส่ค่า Connection String ให้ถูกต้อง (เช่น ที่อยู่ server, ชื่อผู้ใช้, รหัสผ่าน, ชื่อฐานข้อมูล)

- [ ] **7.3 เขียนโค้ดส่วนบันทึกข้อมูล (Insert Data):**
  - [ ] สร้างฟังก์ชันที่รับค่าข้อมูลที่อ่านจาก PLC มาเป็นพารามิเตอร์
  - [ ] เขียนคำสั่ง SQL `INSERT INTO` เพื่อเพิ่มข้อมูลลงในตาราง
  - [ ] ใช้ **Parameterized Queries** เพื่อป้องกัน SQL Injection และเพิ่มความปลอดภัย
  - [ ] จัดการปิด Connection หรือ Cursor ให้เรียบร้อยหลังทำงานเสร็จ

- [ ] **7.4 นำไปรวมกับ Loop การทำงานหลัก:**
  - [ ] ใน Loop หลักของโปรแกรม (Phase 4.4), หลังจากอ่านและแปลงข้อมูลจาก PLC สำเร็จแล้ว
  - [ ] ให้เรียกใช้ฟังก์ชันบันทึกข้อมูลลง Database (จากข้อ 7.3)
  - [ ] เพิ่มการจัดการ Error (Exception Handling) สำหรับกรณีที่บันทึกข้อมูลลง Database ไม่สำเร็จ

- [ ] **7.5 ทดสอบการทำงานของ Database:**
  - [ ] รันโปรแกรมทั้งหมด
  - [ ] เปิด Database Management Tool ขึ้นมาดูข้อมูลในตาราง `plc_data`
  - [ ] ตรวจสอบว่ามีข้อมูลใหม่เข้ามาเรื่อยๆ ตามความถี่ที่ตั้งไว้หรือไม่
  - [ ] ตรวจสอบว่าข้อมูลที่บันทึกถูกต้องตรงกับที่อ่านได้จาก PLC หรือไม่
